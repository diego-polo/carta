<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Unir Columnas - Mesolítico</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&display=swap" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }
        h1 {
            margin-top: 30px;
            color: #3a3a3a;
            letter-spacing: 2px;
        }
        .timer {
            margin: 20px 0;
            font-size: 2rem;
            font-weight: bold;
            color: #fff;
            background: #4e54c8;
            padding: 10px 30px;
            border-radius: 30px;
            box-shadow: 0 2px 8px rgba(78,84,200,0.2);
            letter-spacing: 2px;
        }
        .columns-container {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin-top: 30px;
        }
        .column {
            background: rgba(255,255,255,0.9);
            border-radius: 16px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            padding: 30px 20px;
            min-width: 240px;
        }
        .column h2 {
            text-align: center;
            color: #4e54c8;
            margin-bottom: 18px;
        }
        .item, .drop {
            margin: 12px 0;
            padding: 12px 18px;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .item {
            background: #f7f7fa;
            border: 2px solid #4e54c8;
            color: #4e54c8;
            user-select: none;
        }
        .item.dragging {
            opacity: 0.5;
        }
        .item img {
            width: 44px;
            height: 44px;
            object-fit: cover;
            border-radius: 50%;
            border: 2px solid #bdbdfc;
            background: #fff;
        }
        .drop {
            background: #e0e7ff;
            border: 2px dashed #4e54c8;
            min-height: 32px;
            color: #4e54c8;
            display: flex;
            align-items: center;
            min-height: 48px;
        }
        .drop.filled {
            background: #c3f0ca;
            border: 2px solid #34a853;
            color: #222;
        }
        .drop.incorrect {
            background: #ffd6d6;
            border: 2px solid #ea4335;
            color: #ea4335;
        }
        .btn-reset {
            margin-top: 30px;
            padding: 10px 28px;
            background: #4e54c8;
            color: #fff;
            border: none;
            border-radius: 24px;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.2s;
        }
        .btn-reset:hover {
            background: #6c63ff;
        }
        @media (max-width: 700px) {
            .columns-container {
                flex-direction: column;
                align-items: center;
                gap: 30px;
            }
        }
    </style>
</head>
<body>
    <h1>Unir Columnas: Mesolítico</h1>
    <div class="timer" id="timer">01:00</div>
    <div class="columns-container">
        <div class="column" id="left-column">
            <h2>Conceptos</h2>
        </div>
        <div class="column" id="right-column">
            <h2>Descripciones</h2>
        </div>
    </div>
    <button class="btn-reset" onclick="resetGame()">Reiniciar</button>
    <script>
        // --- Datos del juego con imágenes representativas ---
        const pairs = [
            {
                concepto: "Periodo Mesolítico",
                descripcion: "Transición entre el Paleolítico y el Neolítico, aprox. 10,000-5,000 a.C.",
                imagen: "https://res.cloudinary.com/dmcvdsh4c/image/upload/v1718649606/iceebook/historia-antigua/que-fue-el-periodo-mesolitico_ahukqs.webp"
            },
            {
                concepto: "Caza y recolección",
                descripcion: "Principal forma de subsistencia, aunque se inicia la domesticación de animales.",
                imagen: "https://talayots.es/wp-content/uploads/recolectores-y-cazadores-en-la-america-paleolitica-una-mirada-ancestral.jpg"
            },
            {
                concepto: "utensilios pequeños",
                descripcion: "Pequeñas herramientas de piedra, típicas de este periodo.",
                imagen: "https://talayots.es/wp-content/uploads/herramientas-del-mesolitico-la-edad-de-piedra-en-accion.jpg"
            },
            {
                concepto: "Sedentarismo",
                descripcion: "Comienzan a establecerse en asentamientos temporales cerca de recursos.",
                imagen: "https://elpopular.cronosmedia.glr.pe/original/2020/08/20/5f3ea71e15d9b2090620d7b5.jpg"
            },
            {
                concepto: "Arte Mesolítico",
                descripcion: "Pinturas rupestres más esquemáticas y figuras humanas.",
                imagen: "https://i.pinimg.com/originals/f7/b4/d1/f7b4d134485d6779e1c9aa2438b7e2e3.jpg"
            }
        ];

        // --- Variables globales ---
        let leftItems = [];
        let rightItems = [];
        let timerInterval;
        let timeLeft = 60;
        let draggedItem = null;

        // --- Utilidades ---
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // --- Renderizado del juego ---
        function renderGame() {
            leftItems = pairs.map((p, i) => ({...p, idx: i}));
            rightItems = pairs.map((p, i) => ({...p, idx: i}));
            shuffle(leftItems);
            shuffle(rightItems);

            // Renderizar conceptos con imagen
            const leftCol = document.getElementById('left-column');
            leftCol.innerHTML = '<h2>Conceptos</h2>';
            leftItems.forEach(item => {
                const div = document.createElement('div');
                div.className = 'item';
                div.draggable = true;
                div.dataset.idx = item.idx;

                // Imagen
                const img = document.createElement('img');
                img.src = item.imagen;
                img.alt = item.concepto;

                // Texto
                const span = document.createElement('span');
                span.textContent = item.concepto;

                div.appendChild(img);
                div.appendChild(span);

                div.addEventListener('dragstart', dragStart);
                div.addEventListener('dragend', dragEnd);
                leftCol.appendChild(div);
            });

            // Renderizar descripciones (zonas de drop)
            const rightCol = document.getElementById('right-column');
            rightCol.innerHTML = '<h2>Descripciones</h2>';
            rightItems.forEach(item => {
                const drop = document.createElement('div');
                drop.className = 'drop';
                drop.dataset.idx = item.idx;
                drop.addEventListener('dragover', dragOver);
                drop.addEventListener('drop', dropItem);
                rightCol.appendChild(drop);

                const desc = document.createElement('div');
                desc.textContent = item.descripcion;
                desc.style.marginTop = "6px";
                desc.style.fontSize = "0.98rem";
                desc.style.color = "#555";
                rightCol.appendChild(desc);
            });
        }

        // --- Drag & Drop ---
        function dragStart(e) {
            draggedItem = e.target;
            setTimeout(() => e.target.classList.add('dragging'), 0);
        }
        function dragEnd(e) {
            e.target.classList.remove('dragging');
        }
        function dragOver(e) {
            e.preventDefault();
        }
        function dropItem(e) {
            e.preventDefault();
            if (!draggedItem) return;
            const dropZone = e.target;
            if (dropZone.classList.contains('drop') && !dropZone.classList.contains('filled')) {
                if (draggedItem.dataset.idx === dropZone.dataset.idx) {
                    dropZone.classList.add('filled');
                    // Mostrar imagen y texto en el drop
                    dropZone.innerHTML = '';
                    const img = draggedItem.querySelector('img').cloneNode();
                    img.style.width = "32px";
                    img.style.height = "32px";
                    img.style.marginRight = "8px";
                    dropZone.appendChild(img);
                    const span = document.createElement('span');
                    span.textContent = draggedItem.querySelector('span').textContent;
                    dropZone.appendChild(span);

                    draggedItem.style.visibility = 'hidden';
                    checkWin();
                } else {
                    dropZone.classList.add('incorrect');
                    setTimeout(() => dropZone.classList.remove('incorrect'), 800);
                }
            }
            draggedItem.classList.remove('dragging');
            draggedItem = null;
        }

        // --- Comprobación de victoria ---
        function checkWin() {
            const drops = document.querySelectorAll('.drop');
            if ([...drops].every(d => d.classList.contains('filled'))) {
                clearInterval(timerInterval);
                setTimeout(() => {
                    alert('¡Felicidades! Has completado el juego.');
                }, 600);
            }
        }

        // --- Temporizador ---
        function startTimer() {
            timeLeft = 60;
            updateTimer();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimer();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    document.getElementById('timer').textContent = "¡Tiempo terminado!";
                    setTimeout(() => {
                        window.location.href = "../Mesolitico/juegos_Mesolitico.html";
                    }, 1200);
                }
            }, 1000);
        }
        function updateTimer() {
            const min = String(Math.floor(timeLeft / 60)).padStart(2, '0');
            const sec = String(timeLeft % 60).padStart(2, '0');
            document.getElementById('timer').textContent = `${min}:${sec}`;
        }

        // --- Reiniciar juego ---
        function resetGame() {
            clearInterval(timerInterval);
            renderGame();
            startTimer();
        }

        // --- Inicialización ---
        renderGame();
        startTimer();
    </script>
</body>
</html>